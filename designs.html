<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>keyfabe | designs</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            paper: '#f0f0e6',
            ink: '#1a1a1a',
            'cyan-bright': '#00a8ff',
            'orange-bright': '#ff4719',
            mustard: '#e6b31e',
          },
          fontFamily: {
            sans: ['"Space Grotesk"', 'sans-serif'],
            mono: ['"DM Mono"', 'monospace'],
          }
        }
      }
    }
  </script>
    <style>
    ::selection { background: #ff4719; color: white; }
    .card:hover .stamp { opacity: 1; transform: translate(0,0) rotate(-6deg); }
    .card:hover .scanlines { opacity: 0.12; }
    .card:hover .art { transform: translateY(-4px) scale(1.02); }
    .card:hover .art-hover { opacity: 1; }
    .card:hover .art-default { opacity: 0; }
    #lightbox.show { opacity: 1; pointer-events: auto; }
    #lightbox.show #lightbox-inner { transform: translateY(0); }
    .invert-flash { filter: invert(1); transition: filter 0.15s ease; }
    body.alt-palette-1 { background: #e6b31e; color: #1a1a1a; }
    body.alt-palette-1 .card { background: #fff; }
    body.alt-palette-2 { background: #00a8ff; color: #1a1a1a; }
    body.alt-palette-2 .card { background: #fff; }
    body.alt-palette-3 { background: #ff4719; color: #1a1a1a; }
    body.alt-palette-3 .card { background: #fff; }
    body.glitch { animation: glitchFlash 0.1s ease; }
    @keyframes glitchFlash {
      0% { transform: translate(0); }
      50% { transform: translate(-2px, 1px); }
      100% { transform: translate(0); }
    }
    .card {
      transition: box-shadow 0.15s ease;
      box-shadow: 6px 6px 0px #1a1a1a;
    }
    .card:hover {
      transform: none;
      box-shadow: 6px 6px 0px #1a1a1a;
    }
    /* Channel change overlay */
    #channel-flash {
      position: fixed;
      inset: 0;
      background: repeating-linear-gradient(0deg, rgba(0,0,0,0.15) 0px, rgba(0,0,0,0.15) 2px, transparent 2px, transparent 4px),
                  radial-gradient(circle at 20% 20%, rgba(255,255,255,0.1), transparent 25%),
                  radial-gradient(circle at 80% 80%, rgba(0,168,255,0.12), transparent 25%);
      mix-blend-mode: screen;
      opacity: 0;
      pointer-events: none;
      z-index: 50;
    }
    #channel-flash.show {
      opacity: 0.8;
      animation: channelSweep 0.25s ease forwards;
    }
    @keyframes channelSweep {
      0% { transform: translateY(-10%); opacity: 0.6; }
      50% { transform: translateY(5%); opacity: 0.4; }
      100% { transform: translateY(0); opacity: 0; }
    }
    .glitch-btn {
      position: relative;
      overflow: hidden;
    }
    .glitch-btn::before,
    .glitch-btn::after {
      content: attr(data-text);
      position: absolute;
      left: 0;
      right: 0;
      text-align: center;
      pointer-events: none;
      color: #00a8ff;
      mix-blend-mode: multiply;
      opacity: 0;
    }
    .glitch-btn::before { top: 2px; }
    .glitch-btn::after { top: -2px; color: #ff4719; }
    .glitch-btn.glitching::before,
    .glitch-btn.glitching::after {
      animation: btn-glitch 0.18s steps(2) 1;
      opacity: 1;
    }
    @keyframes btn-glitch {
      0% { transform: translate(0); }
      50% { transform: translate(-4px, 2px); }
      100% { transform: translate(3px, -3px); }
    }
  </style>
</head>
<body class="bg-paper text-ink font-sans">
  <div class="max-w-7xl mx-auto px-6 md:px-12 py-12">
    <header class="flex items-center justify-between gap-4 mb-10">
      <div class="text-2xl font-bold lowercase tracking-tight">keyfabe</div>
      <a href="./" class="font-mono text-xs uppercase border-2 border-ink px-3 py-2 bg-white shadow-[4px_4px_0px_#1a1a1a] hover:-translate-y-0.5 hover:-translate-x-0.5 transition">
        back to main
      </a>
    </header>

    <div class="mb-6">
      <div class="inline-block relative">
        <span class="absolute text-cyan-bright -translate-x-1 -translate-y-1">designs</span>
        <span class="absolute text-orange-bright translate-x-1 translate-y-1">designs</span>
        <h1 class="relative text-4xl md:text-6xl font-bold uppercase">designs</h1>
      </div>
      <p class="font-mono text-sm mt-3">catalog: error-corrected Â· all current prints</p>
    </div>

    <div id="design-grid" class="grid grid-cols-1 md:grid-cols-3 gap-8"></div>
    <div id="channel-flash"></div>
    <audio id="pop-sound" src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAIA+AAACABAAZGF0YQgAAAAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA" preload="auto"></audio>
    <div id="lightbox" class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-40 opacity-0 pointer-events-none transition duration-300">
      <div id="lightbox-inner" class="relative bg-paper border-2 border-ink shadow-[8px_8px_0px_#000] p-4 translate-y-6 transition duration-300 max-w-4xl w-[90vw]">
        <button id="close-lightbox" data-text="back to simulation" class="glitch-btn absolute top-3 right-3 font-mono text-xs uppercase border-2 border-ink px-2 py-1 bg-white shadow-[3px_3px_0px_#1a1a1a]">back to simulation</button>
        <div class="w-full h-full flex items-center justify-center">
          <img id="lightbox-img" src="" alt="design full" class="max-h-[80vh] max-w-full object-contain">
        </div>
      </div>
    </div>
  </div>
  <script>
    const arts = [
      './public/design2.png',
      "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 360 480'%3E%3Crect width='360' height='480' fill='none'/%3E%3Crect x='92' y='72' width='176' height='320' rx='24' fill='%23f0f0e6' stroke='%231a1a1a' stroke-width='8'/%3E%3Crect x='140' y='88' width='80' height='32' rx='8' fill='%2300a8ff' stroke='%231a1a1a' stroke-width='8'/%3E%3Cpath d='M116 152h128M116 192h128M116 232h128M116 272h128M116 312h104' stroke='%231a1a1a' stroke-width='8' stroke-linecap='round'/%3E%3Crect x='136' y='332' width='88' height='36' rx='8' fill='%23ff4719' stroke='%231a1a1a' stroke-width='8'/%3E%3Cpath d='M196 132c0 6-10 10-16 10s-16-4-16-10' stroke='%231a1a1a' stroke-width='8' fill='none'/%3E%3C/svg%3E",
      "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 360 480'%3E%3Crect width='360' height='480' fill='none'/%3E%3Ccircle cx='180' cy='140' r='72' fill='%23f0f0e6' stroke='%231a1a1a' stroke-width='8'/%3E%3Cpath d='M132 212h96v56c0 24-24 40-48 40s-48-16-48-40Z' fill='%23ff4719' stroke='%231a1a1a' stroke-width='8'/%3E%3Cpath d='M152 118c0 14 18 22 28 22s28-8 28-22' stroke='%231a1a1a' stroke-width='8' fill='none'/%3E%3Ccircle cx='154' cy='130' r='8' fill='%231a1a1a'/%3E%3Ccircle cx='206' cy='130' r='8' fill='%231a1a1a'/%3E%3Cpath d='M168 256h24l12 52-24 12-24-12Z' fill='%2300a8ff' stroke='%231a1a1a' stroke-width='8'/%3E%3Crect x='96' y='342' width='168' height='20' rx='6' fill='%231a1a1a'/%3E%3Crect x='96' y='370' width='168' height='18' rx='6' fill='%2300a8ff'/%3E%3C/svg%3E"
    ];

    const grid = document.getElementById('design-grid');
    const cards = [];
    for (let i = 1; i <= 50; i++) {
      const art = arts[(i - 1) % arts.length];
      const idx = String(i).padStart(2, '0');
      const firstHover = i === 1
        ? `<img src="/mockup2.jpg" alt="design ${idx} hover" class="art art-hover max-h-full max-w-full object-contain p-2 transition duration-200 absolute inset-0 m-auto opacity-0" />`
        : '';
      const firstDefaultClass = i === 1 ? 'art art-default' : 'art';
      cards.push(`
        <div class="card border-2 border-ink bg-white shadow-[6px_6px_0px_#1a1a1a] transition duration-200" data-art="${art}" data-mockup="${i === 1 ? '/mockup2.jpg' : art}" data-idx="${i}">
          <div class="relative aspect-square border-b-2 border-ink flex items-center justify-center p-6">
            <div class="absolute inset-0 opacity-0 scanlines bg-[linear-gradient(0deg,rgba(0,0,0,0.08)_1px,transparent_1px)] bg-[length:4px_4px] transition duration-200 pointer-events-none"></div>
            <div class="absolute top-3 right-3 px-3 py-1 font-mono text-[10px] uppercase border-2 border-ink bg-cyan-bright text-ink shadow-[4px_4px_0px_#1a1a1a] opacity-0 stamp transition duration-200 transform translate(4px, -6px) z-20 pointer-events-none">APPROVED</div>
            <div class="w-full h-full border-2 border-dashed border-ink flex items-center justify-center relative overflow-hidden">
              <img src="${art}" alt="design ${idx}" class="${firstDefaultClass} max-h-full max-w-full object-contain p-2 transition duration-200 relative z-10" />
              ${firstHover ? firstHover.replace('object-cover p-0 scale-110', 'object-contain p-2') : ''}
            </div>
          </div>
          <div class="p-4 space-y-2">
            <div class="font-mono text-[10px] uppercase tracking-[0.15em]">print ${idx}</div>
            <h2 class="text-xl font-bold uppercase leading-tight">design ${idx}</h2>
            <p class="font-mono text-sm text-ink/80">lorem ipsum dolor sit amet for design ${idx}.</p>
            <div class="flex gap-2 pt-2">
              <a href="./cart.html" class="font-mono text-xs uppercase border-2 border-ink px-3 py-2 bg-white shadow-[3px_3px_0px_#1a1a1a] hover:-translate-y-0.5 hover:-translate-x-0.5 transition">buy</a>
              <a href="./cart.html" class="font-mono text-xs uppercase border-2 border-ink px-3 py-2 bg-cyan-bright text-ink shadow-[3px_3px_0px_#1a1a1a] hover:-translate-y-0.5 hover:-translate-x-0.5 transition">add to cart</a>
            </div>
          </div>
        </div>
      `);
    }
    grid.innerHTML = cards.join('');

    // Lightbox interactions
    const lightbox = document.getElementById('lightbox');
    const lightboxInner = document.getElementById('lightbox-inner');
    const lightboxImg = document.getElementById('lightbox-img');
    const closeBtn = document.getElementById('close-lightbox');
    const channelFlash = document.getElementById('channel-flash');

    const body = document.body;
    const paletteClasses = ['alt-palette-1', 'alt-palette-2', 'alt-palette-3'];

    const openLightbox = (src) => {
      lightboxImg.src = src;
      lightbox.classList.add('show');
    };

    const closeLightbox = () => {
      lightbox.classList.remove('show');
      lightboxImg.src = '';
      body.classList.add('quake');
      if (channelFlash) {
        channelFlash.classList.remove('show');
        void channelFlash.offsetWidth;
        channelFlash.classList.add('show');
      }

      // Invert flash then swap palette
      body.classList.add('invert-flash');
      setTimeout(() => {
        body.classList.remove('invert-flash');
        const paletteClass = ['alt-palette-1', 'alt-palette-2', 'alt-palette-3'][Math.floor(Math.random()*3)];
        body.classList.remove('alt-palette-1', 'alt-palette-2', 'alt-palette-3');
        body.classList.add(paletteClass);
      }, 120);
    };

    if (grid) {
      grid.querySelectorAll('.card').forEach((card) => {
        const idxAttr = card.getAttribute('data-idx');
        const idxNum = parseInt(idxAttr || '0', 10);
        const paletteClass = paletteClasses[(idxNum - 1) % paletteClasses.length];

        card.addEventListener('mouseenter', () => {
          body.classList.remove(...paletteClasses);
          body.classList.add(paletteClass, 'glitch');
          setTimeout(() => body.classList.remove('glitch'), 120);
        });

        card.addEventListener('mouseleave', () => {
          body.classList.remove(...paletteClasses, 'glitch');
        });

        card.addEventListener('click', (e) => {
          const target = e.target;
          const tag = target && target.tagName ? target.tagName.toUpperCase() : '';
          if (tag === 'A' || tag === 'BUTTON') return;
          const mockup = card.getAttribute('data-mockup') || card.getAttribute('data-art');
          if (mockup) openLightbox(mockup);
        });
      });
    }

    closeBtn?.addEventListener('click', closeLightbox);
    closeBtn?.addEventListener('click', () => closeBtn.classList.add('glitching'));
    closeBtn?.addEventListener('animationend', () => closeBtn.classList.remove('glitching'));
    lightbox?.addEventListener('click', (e) => {
      if (e.target === lightbox) closeLightbox();
    });
  </script>
</body>
</html>
